server.js :דוגמא פשוטה לקוד צד שרת הנמצא בתוך קובץ שנקרא

const express = require('express'); </br>
const bodyParser = require('body-parser')</br>
const app = express();</br>

app.use(bodyParser.json())

const users = [];

app.post('/users', function(req, res) {</br>
    users.push(req.body);</br>
    console.log(req.body);</br>
    res.sendStatus(201);</br>
});</br>

app.get('/users', function(req, res) {</br>
    res.send({ users: users });</br>
});</br>

app.listen(8080);


Node.JS - על מנת להפעיל את קוד צד השרת יש להתקין על המכונה את ה </br>
curl על מנת להפעיל את הקוד משורת הפקודה יש לוודא שמותקן גם  </br>

(npm install :כותבים את הפקודה package.JSON - בתיקיה של השרת שבה יש את ה</br>
node_modules שמביאה את הרשימה שיש שם מהאינטרנט ומכניסה אותה לתוך תיקיה שנקראת)</br>

*** npm init -y</br>
*** npm install --save express body-parser lodash socket.io</br>

node server.js לאחר מכן באותה תיקיה מפעילים את קוד צד השרת באמצעות הפקודה </br>
GET/POST :וכעת השרת מופעל ואפשר לפנות אליו באמצעות אחד מהפעלים </br>

GET:
curl localost:8080/users     (due to this row in server: app.listen(8080))

POST:
curl -H "Content-Type: application/json" -d '{ "name" : "jim" }' localhost:8080/users



# Client / Server Ajax:
1.) const xhr = new XMLHttpRequest(); גישת האירועים
2.) await fetch(url,optionsObj); הבטחות

-----------------------------------------------------------------   גישת האירועים   -----------------------------------------------------------------------
1. XMLHttpRequest and events</br>
  Verb (GET / POST) + Path (/users) + Request Body ({ name: 'jim', email: 'jim@gmail.com' })</br>
  Request Headers (Content-Type: application/json)</br>

2. CORS and File:// url restrictions
  - Running our code in a localhost:// server
  - npm install --global http-server
  - In the "client" folder run: 
    http-server -p 9090 -c-1

3. Demo Time - Server API

4. Demo Time - Client Code
  - Login
  - Get new messages
  - Send a message

 ------- example -------

 login(username) {</br>
        const xhr = new XMLHttpRequest();</br>
        xhr.open('POST', `${serverUrl}/login`);</br>
        xhr.setRequestHeader('Content-Type', 'application/json');</br>
        xhr.send(JSON.stringify({ username: username }));</br>

        xhr.addEventListener('load', this.loginComplete.bind(this));
        xhr.addEventListener('error', this.error.bind(this));
  }

  loginComplete(evt) {</br>
        const xhr = evt.target;</br>
        if (xhr.status !== 200) { return this.error(evt) };</br>
</br>
        const data = JSON.parse(xhr.responseText);
        this.token = data.token;
        console.log(`Got server token: ${this.token}`);
  }

-----------------------------------------------------------------   גישת ההבטחות עם פונקציות אסינכרוניות  -----------------------------------------------
# Async Communication with Fetch API

 ------- example -------

async login(username) {</br>
        try {</br>
            const response = await fetch(`${serverUrl}/login`,{</br>
                method: 'POST',</br>
                headers: {</br>
                    'Content-Type':'application/json',</br>
                },</br>
                body: JSON.stringify({username}),</br>
                mode: 'cors',</br>
            });</br>
            const data = await response.json();</br>
            this.token = data.token;</br>
            console.log(`Got token: ${this.token}`);</br>
        } catch(err) {</br>
            alert("Oops that didn't work "+err);</br>
        }</br>
    }</br>

